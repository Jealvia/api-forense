{
  "sri_verificado": false,
  "mensaje": "Análisis forense de imagen JPEG completado. No se puede validar con SRI (solo PDFs).",
  "tipo_archivo": "JPEG",
  "coincidencia": "no",
  "diferencias": {},
  "diferenciasProductos": [],
  "resumenProductos": {
    "num_sri": 0,
    "num_imagen": 0,
    "total_sri_items": 0,
    "total_imagen_items": 0
  },
  "factura": {
    "ruc": null,
    "razonSocial": null,
    "fechaEmision": null,
    "importeTotal": null,
    "claveAcceso": null,
    "detalles": []
  },
  "riesgo": {
    "score": 90,
    "nivel": "alto",
    "es_falso_probable": true,
    "prioritarias": [
      {
        "check": "Extracción de texto OCR",
        "detalle": {
          "caracteres_extraidos": 0,
          "umbral_minimo": 50,
          "porcentaje_extraccion": "0.0%",
          "calidad_imagen": "BAJA",
          "posibles_causas": [
            "Imagen de baja resolución",
            "Texto muy pequeño o borroso",
            "Fondo con poco contraste",
            "Imagen escaneada de mala calidad"
          ],
          "recomendacion": "Mejorar calidad de imagen o usar OCR más avanzado"
        },
        "penalizacion": 30
      },
      {
        "check": "Campos críticos de factura",
        "detalle": {
          "campos_faltantes": ["ruc", "razonSocial", "fechaEmision", "importeTotal"],
          "campos_encontrados": [],
          "total_campos": 4,
          "porcentaje_completitud": "0.0%",
          "campos_detalle": {
            "ruc": {
              "encontrado": false,
              "valor": null,
              "patron_buscado": "RUC[:\s]*(\d{13})"
            },
            "razonSocial": {
              "encontrado": false,
              "valor": null,
              "patron_buscado": "Razón Social[:\s]*([^\n]+)"
            },
            "fechaEmision": {
              "encontrado": false,
              "valor": null,
              "patron_buscado": "Fecha[:\s]*(\d{1,2}[\/\-]\d{1,2}[\/\-]\d{2,4})"
            },
            "importeTotal": {
              "encontrado": false,
              "valor": null,
              "patron_buscado": "Total[:\s]*\$?(\d+[.,]\d{2})"
            }
          },
          "posibles_causas": [
            "Texto no reconocido por OCR",
            "Formato de factura no estándar",
            "Campos en ubicaciones inusuales",
            "Calidad de imagen insuficiente"
          ],
          "recomendacion": "Verificar formato de factura y calidad de imagen"
        },
        "penalizacion": 40
      },
      {
        "check": "Clave de acceso SRI",
        "detalle": {
          "clave_encontrada": false,
          "longitud_esperada": 49,
          "patron_buscado": "(\d{49})",
          "ubicaciones_buscadas": [
            "Clave de Acceso:",
            "Clave Acceso:",
            "Código de autorización:",
            "Número de autorización:"
          ],
          "posibles_causas": [
            "Clave de acceso no visible en la imagen",
            "Formato de clave no reconocido",
            "Texto muy pequeño o borroso",
            "Clave en ubicación inusual"
          ],
          "impacto": "Sin clave de acceso no se puede validar con SRI",
          "recomendacion": "Verificar que la clave de acceso esté visible y legible"
        },
        "penalizacion": 20
      },
      {
        "check": "Doble compresión detectada",
        "detalle": {
          "detectado": true,
          "confianza": "ALTA",
          "periodicidad_detectada": true,
          "varianza_alta": false,
          "num_peaks": 5,
          "ac_variance": 186.0886760756579,
          "dc_variance": 265282.49949094915,
          "interpretacion": "La imagen fue comprimida múltiples veces, indicando posible edición",
          "posibles_causas": [
            "Imagen editada y re-guardada",
            "Conversión entre formatos múltiples",
            "Optimización de imagen repetida",
            "Edición con software que re-comprime"
          ],
          "nivel_sospecha": "ALTO",
          "recomendacion": "Verificar historial de edición de la imagen"
        },
        "penalizacion": 15
      },
      {
        "check": "Inconsistencias en ruido y bordes",
        "detalle": {
          "detectado": true,
          "nivel_sospecha": "MEDIO",
          "laplacian_variance": 1159.4504305155554,
          "edge_density": 0.06105625,
          "num_lines": 709,
          "parallel_lines": 10,
          "outlier_ratio": 0.07142857142857142,
          "gradient_peaks": 101457,
          "peak_ratio": 0.07045625,
          "interpretacion": "Análisis de ruido y bordes detecta inconsistencias en patrones locales",
          "posibles_causas": [
            "Edición local con herramientas de clonado",
            "Pegado de elementos con diferentes niveles de ruido",
            "Aplicación de filtros selectivos",
            "Modificación de áreas específicas"
          ],
          "indicadores_clave": [
            "Ratio de outliers: 7.14%",
            "Densidad de bordes: 6.11%",
            "Líneas paralelas: 10"
          ],
          "recomendacion": "Examinar áreas con patrones de ruido inconsistentes"
        },
        "penalizacion": 18
      }
    ]
  },
  "validacion_firmas": {
    "resumen": {
      "total_firmas": 0,
      "firmas_validas": 0,
      "firmas_invalidas": 0,
      "con_certificados": 0,
      "con_timestamps": 0,
      "con_politicas": 0,
      "porcentaje_validas": 0
    },
    "dependencias": {
      "asn1crypto": false,
      "oscrypto": false,
      "certvalidator": false
    },
    "analisis_sri": {
      "es_documento_sri": false,
      "ruc_emisor": null,
      "razon_social": null,
      "numero_documento": null,
      "fecha_emision": null,
      "clave_acceso": null,
      "ambiente": null,
      "tipo_emision": null
    },
    "validacion_pdf": {
      "firma_detectada": false,
      "tipo_firma": "ninguna",
      "es_pades": false,
      "metadatos": {
        "numero_firmas": 0
      }
    },
    "tipo_documento": "jpeg",
    "firma_detectada": false
  },
  "analisis_detallado": {
    "tipo_archivo": {
      "tipo": "JPEG",
      "extension": "jpg",
      "mime_type": "image/jpeg",
      "valido": true
    },
    "metadatos": {
      "exif": {},
      "iptc": {},
      "xmp": {},
      "basicos": {
        "formato": "JPEG",
        "modo": "RGB",
        "tamaño": [900, 1600],
        "ancho": 900,
        "alto": 1600,
        "has_transparency": false
      },
      "sospechosos": []
    },
    "capas": {
      "tiene_capas": false,
      "total_capas": 0,
      "capas": [],
      "capas_ocultas": 0,
      "modos_mezcla": [],
      "sospechosas": [],
      "mensaje": "Tipo de archivo JPEG no soporta capas"
    },
    "superposicion_texto": {
      "tiene_texto_superpuesto": false,
      "areas_sospechosas": [],
      "indicadores": ["Patrones de texto detectados"],
      "probabilidad": 0.4
    },
    "analisis_forense": {
      "hashes": {
        "md5": "ccc6e10c532193cfe9fada37c877499c",
        "sha1": "e0e3c0ea75598a26b134493a305623694b3227ec",
        "sha256": "f385de45055bc0d1a381299d33fbbb1b7bfd72beaeb9bfd4806e18187489313c",
        "sha512": "562cc33191128a8cd0a78776bd12d6dd1c327bee27ccd0787c0f92d7fab89d1548668b5ec66d53ea3cf73e48a84d977d87a00fb2c3a3085d8978e697792d2550",
        "blake2b": "4ffcd5f9f5b48c38ef21161c122cb9b47d4ee8c8dadcc29e0d7d62f3beae5aeb681aeb44f21f8fdc89b5f7fb4ac5868281ae15b91d8ff43528354dd218e11dcc",
        "timestamp": "2025-09-19T09:51:35.934865",
        "phash": "d5554a2a6a2a6bb3",
        "dhash": "80824a6a3c279ba9",
        "whash": "0000fefefebf0f00",
        "colorhash": "06007000000",
        "crop_resistant_hash": "b24a2a7c3c77b9a9,4080ba4a5a2a603c,1f4f4c57767f0300"
      },
      "timestamp_analisis": "2025-09-19T09:51:36.727410",
      "tipo_archivo": "JPEG",
      "ela": {
        "ela_mean": 0.1674516201019287,
        "ela_std": 0.4086008369922638,
        "ela_max": 7,
        "porcentaje_sospechoso": 1.0632175925925924,
        "edge_density": 0.08535972222222223,
        "tiene_ediciones": false,
        "nivel_sospecha": "NORMAL"
      },
      "doble_compresion": {
        "tiene_doble_compresion": true,
        "periodicidad_detectada": true,
        "varianza_alta": false,
        "num_peaks": 5,
        "ac_variance": 186.0886760756579,
        "dc_variance": 265282.49949094915,
        "confianza": "ALTA"
      },
      "ruido_bordes": {
        "laplacian_variance": 1159.4504305155554,
        "edge_density": 0.06105625,
        "num_lines": 709,
        "parallel_lines": 10,
        "outlier_ratio": 0.07142857142857142,
        "gradient_peaks": 101457,
        "peak_ratio": 0.07045625,
        "tiene_edicion_local": true,
        "nivel_sospecha": "MEDIO"
      },
      "phash_bloques": {
        "num_bloques": 350,
        "mean_difference": 29.501432664756447,
        "std_difference": 5.195669698972803,
        "max_difference": 46,
        "outlier_ratio": 0.03724928366762178,
        "tiene_diferencias_locales": false,
        "nivel_sospecha": "BAJO"
      },
      "ssim_regional": {
        "num_comparaciones": 149,
        "mean_ssim": 0.5037123702033203,
        "std_ssim": 0.19625355892733246,
        "min_ssim": 0.0720652718049213,
        "low_similarity_ratio": 0.006711409395973154,
        "tiene_inconsistencias": false,
        "nivel_sospecha": "BAJO"
      },
      "grado_confianza": {
        "grado_confianza": "BAJO",
        "porcentaje_confianza": 33.3,
        "puntuacion": 4,
        "max_puntuacion": 12,
        "evidencias": [
          "Doble compresión detectada (confianza: ALTA)",
          "Edición local detectada (nivel: MEDIO)"
        ],
        "justificacion": "Pocas o ninguna evidencia de manipulación",
        "recomendacion": "IMAGEN APARENTEMENTE AUTÉNTICA - Sin embargo, se recomienda verificar el canal de origen"
      }
    },
    "probabilidad_manipulacion": 0.1,
    "nivel_riesgo": "LOW",
    "indicadores_sospechosos": [],
    "resumen": {
      "tiene_metadatos_sospechosos": false,
      "tiene_texto_superpuesto": false,
      "tiene_capas_ocultas": false,
      "tiene_evidencias_forenses": false,
      "total_indicadores": 0
    }
  },
  "checks_imagen": [
    {
      "check": "JavaScript embebido",
      "detalle": false,
      "penalizacion": 0
    },
    {
      "check": "Metadatos sospechosos",
      "detalle": false,
      "penalizacion": 0
    },
    {
      "check": "Texto superpuesto",
      "detalle": false,
      "penalizacion": 0
    },
    {
      "check": "Capas ocultas",
      "detalle": false,
      "penalizacion": 0
    },
    {
      "check": "Evidencias forenses de manipulación",
      "detalle": false,
      "penalizacion": 0
    },
    {
      "check": "Análisis ELA sospechoso",
      "detalle": false,
      "penalizacion": 0
    },
    {
      "check": "Doble compresión detectada",
      "detalle": true,
      "penalizacion": 15
    },
    {
      "check": "Inconsistencias en ruido y bordes",
      "detalle": true,
      "penalizacion": 18
    },
    {
      "check": "Análisis perceptual hash sospechoso",
      "detalle": false,
      "penalizacion": 0
    },
    {
      "check": "Análisis SSIM regional sospechoso",
      "detalle": false,
      "penalizacion": 0
    }
  ],
  "texto_extraido": ""
}
